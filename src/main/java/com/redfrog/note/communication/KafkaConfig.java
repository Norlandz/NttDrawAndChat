//_______________________________
//_
//_____________________________
//_
//_____________________________________________
//_________________________________________________________
//___________________________________________________
//_________________________________________________________
//________________________________________________________
//________________________________________________________
//___________________________________________________
//_________________________________________________________
//_________________________________________________________________
//_______________________________________________________________
//_
//_______________________________________________
//______________________________________________________
//________________________________________________
//_________________________________________
//______________________________________________
//_____________________________________________________________________________
//________________________________________________
//_________________________________________________________
//____________________________________________________
//___________________________________________________
//________________________________________________
//______________________________________________________________________
//________________________________________________________________________
//___________________________________________________
//___________________________________________________________________
//________________________________________________________________________
//___________________________________________________
//______________________________________________________________________
//____________________________________________________________________
//_
//______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
//_
//_____________________________
//_
//_________________________________________________________________________________________
//____________________________________________________________
//_____________________________________________________________
//_
//___________
//_________________________________________________________________
//_
//_____________________________________________________________________________________________
//__________________________________________________________________________________________
//__________________________________________________________________________________________
//_____________________________________________________________________________________________________________
//_________________________________________________________________________________________________________________
//_____________________________________________________________________________________________________________________
//_________________________________________________________________________________________________________________________
//___________________________________________________________________________________________________________________________
//_______________________________________________________________________________________________________________________________
//_
//_____________________________________________________________________________________________
//____________________________________________________________________________________
//____
//_
//___________________________________________________________________________________________
//_________________________________________________________________________________________________
//_
//_________________________________________________________________________
//_____________________________________________________________________
//___________________________________________________________________________________________
//___________________________________________________________________________________________________________________________________
//_________________________________________________________________________
//_________________________________________________________________________________
//_________________________________________________________________________
//_______________________________________________________________________________________________
//_____________________________________________________________________________________
//_____________________________________________________________________________________________________
//_____________________________________________________________________________________________________
//___________________________________________________________________________________________
//___________________________________________________________
//___________________________________________________________
//_______________________________________________________________________
//_______________________________________________________________________________
//_
//___________________________________________________________________________________________
//_______________________________________________________________________________________
//_____________________________________________________________________________________________________________
//_____________________________________________________________________________________________________________________________________________________
//___________________________________________________________________________________________
//___________________________________________________________________________________________________
//___________________________________________________________________________________________
//_________________________________________________________________________________________________________________
//_______________________________________________________________________________________________________
//_______________________________________________________________________________________________________________________
//_______________________________________________________________________________________________________________________
//_____________________________________________________________________________________________________________
//_____________________________________________________________________________
//_____________________________________________________________________________
//_________________________________________________________________________________________
//_________________________________________________________________________________________________
//_
//__________________________
//_
//__________________________________________________________________________________________________________________________
//______________________________________________________________________________________________________________________
//____________________________________________________________________________________________________________________________________________
//____________________________________________________________________________________________________________________________________________________________________________________
//__________________________________________________________________________________________________________________________
//__________________________________________________________________________________________________________________________________
//__________________________________________________________________________________________________________________________
//________________________________________________________________________________________________________________________________________________
//______________________________________________________________________________________________________________________________________
//______________________________________________________________________________________________________________________________________________________
//______________________________________________________________________________________________________________________________________________________
//____________________________________________________________________________________________________________________________________________
//____________________________________________________________________________________________________________
//____________________________________________________________________________________________________________
//________________________________________________________________________________________________________________________
//________________________________________________________________________________________________________________________________
//_
//__________________________________________________________________________________________________________________________
//______________________________________________________________________________________________________________________
//____________________________________________________________________________________________________________________________________________
//____________________________________________________________________________________________________________________________________________________________________________________
//__________________________________________________________________________________________________________________________
//__________________________________________________________________________________________________________________________________
//__________________________________________________________________________________________________________________________
//________________________________________________________________________________________________________________________________________________
//______________________________________________________________________________________________________________________________________
//______________________________________________________________________________________________________________________________________________________
//______________________________________________________________________________________________________________________________________________________
//____________________________________________________________________________________________________________________________________________
//____________________________________________________________________________________________________________
//____________________________________________________________________________________________________________
//________________________________________________________________________________________________________________________
//________________________________________________________________________________________________________________________________
//_
//__________________
//_
//_________________________________________________________________________
//____________________________________________________________________________________________
//__________________________________________________________________________________________________________________________
//_
//______________________________________
//___________
//_________________________________________________________________________________________
//_________________________________________________________________________________________
//_________________________________________________________________________________________
//_________________________________________________________________________________________
//_________________________________________________________________________________________
//_________________________________________________________________________________________
//_________________________________________________________________________________________
//_________________________________________________________________________________________
//_________________________________________________________________________________________
//_________________________________________________________________________________________
//_________________________________________________________________________________________
//_________________________________________________________________________________________
//_________________________________________________________________________________________
//_________________________________________________________________________________________
//_________________________________________________________________________________________
//_________________________________________________________________________________________
//_
//___________________________________________________________________________________________
//___________________________________________________________________________________________
//___________________________________________________________________________________________
//___________________________________________________________________________________________
//___________________________________________________________________________________________
//___________________________________________________________________________________________
//___________________________________________________________________________________________
//___________________________________________________________________________________________
//___________________________________________________________________________________________
//___________________________________________________________________________________________
//___________________________________________________________________________________________
//___________________________________________________________________________________________
//___________________________________________________________________________________________
//___________________________________________________________________________________________
//___________________________________________________________________________________________
//___________________________________________________________________________________________
//____
//_
//______________
//_
//___________________________________________________________________________________________
//_
//___________
//_____________________________________________________________________________________________
//_
//____________________________________________________________________________________
//__________________________________________________________________________________
//_____________________________________________________________________________________________
//_________________________________________________________________________________________________________________
//____________________________________________________________________________________
//________________________________________________________________________________________
//____________________________________________________________________________________
//_______________________________________________________________________________________________
//__________________________________________________________________________________________
//__________________________________________________________________________________________________
//__________________________________________________________________________________________________
//_____________________________________________________________________________________________
//_____________________________________________________________________________
//_____________________________________________________________________________
//___________________________________________________________________________________
//_______________________________________________________________________________________
//_
//_________________________________________________________________________________
//____
//_
//______________
//_
//__________________________________________________________________________________________________
//___________________________________________________________________________________________________________________________________________________
//___________________________________________________________________________________________________________________________________________________
//_____________________________________________________________________________________________________
//________________________________________________________________________________________________
//_
//__

package com.redfrog.note.communication;

import java.util.Properties;

import org.apache.kafka.clients.admin.Admin;
import org.apache.kafka.clients.admin.AdminClientConfig;
import org.apache.kafka.clients.consumer.Consumer;
import org.apache.kafka.clients.consumer.ConsumerConfig;
import org.apache.kafka.clients.consumer.KafkaConsumer;
import org.apache.kafka.clients.producer.KafkaProducer;
import org.apache.kafka.clients.producer.Producer;
import org.apache.kafka.clients.producer.ProducerConfig;
import org.apache.kafka.common.serialization.StringDeserializer;
import org.apache.kafka.common.serialization.StringSerializer;

import com.redfrog.note.event.ArrowMovedEvent;
import com.redfrog.note.event.FunctionExecutionEvent;
import com.redfrog.note.event.NodeCreatedEvent;
import com.redfrog.note.event.NodeLayerMovedEvent;
import com.redfrog.note.event.NodeMovedEvent;
import com.redfrog.note.event.NodeRelationshipContainmentStatusChangedEvent;
import com.redfrog.note.event.NodeRemovedEvent;
import com.redfrog.note.event.NodeShapeScaleChangedEvent;
import com.redfrog.note.event.NodeShapeSizeChangedEvent;
import com.redfrog.note.event.PaintDotChangedEvent;
import com.redfrog.note.event.PaintRectClearEvent;
import com.redfrog.note.event.TextChangedEvent;
import com.redfrog.note.event.nodestatus.NodeFocusStatusChangedEvent;
import com.redfrog.note.event.session.SessionBeignEvent;
import com.redfrog.note.event.traversal.RedoCompensationStepAddedEvent;
import com.redfrog.note.event.traversal.RedoEvent;
import com.redfrog.note.event.traversal.UndoCheckpointPlacedEvent;
import com.redfrog.note.event.traversal.UndoCompensationStepAddedEvent;
import com.redfrog.note.event.traversal.UndoEvent;
import com.redfrog.note.fundamental.NodeEvent;
import com.redfrog.note.serialization.SerializationUtilsDeserializer;
import com.redfrog.note.serialization.SerializationUtilsSerializer;
import com.redfrog.note.session.StaticValueDebug;
import com.redfrog.note.session.StaticValueDebug_Kafka;
import com.redfrog.note.util.KafkaUtil;

/**________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________*/

//_______________

public class KafkaConfig {

  //___________________________________________________________________________
  //__________________________________________________________

  //_______________________________________________________

  public Properties kProp_Admin = new Properties();
  public Properties kProp_Producer = new Properties();
  public Properties kProp_Consumer = new Properties();

  public Producer<String, NodeCreatedEvent> kProducer_NodeCreatedEvent;
  public Producer<String, NodeMovedEvent> kProducer_NodeMovedEvent;
  public Producer<String, NodeShapeSizeChangedEvent> kProducer_NodeShapeSizeChangedEvent;
  public Producer<String, NodeRelationshipContainmentStatusChangedEvent> kProducer_NodeRelationshipContainmentStatusChangedEvent;
  public Producer<String, TextChangedEvent> kProducer_TextChangedEvent;
  public Producer<String, PaintDotChangedEvent> kProducer_PaintDotChangedEvent;
  public Producer<String, NodeRemovedEvent> kProducer_NodeRemovedEvent;
  public Producer<String, NodeFocusStatusChangedEvent> kProducer_NodeFocusStatusChangedEvent;
  public Producer<String, FunctionExecutionEvent> kProducer_FunctionExecutionEvent;
  public Producer<String, UndoCompensationStepAddedEvent> kProducer_UndoCompensationStepAddedEvent;
  public Producer<String, RedoCompensationStepAddedEvent> kProducer_RedoCompensationStepAddedEvent;
  public Producer<String, UndoCheckpointPlacedEvent> kProducer_UndoCheckpointPlacedEvent;
  public Producer<String, UndoEvent> kProducer_UndoEvent;
  public Producer<String, RedoEvent> kProducer_RedoEvent;
  public Producer<String, ArrowMovedEvent> kProducer_ArrowMovedEvent;
  public Producer<String, PaintRectClearEvent> kProducer_PaintRectClearEvent;
  public Producer<String, NodeLayerMovedEvent> kProducer_NodeLayerMovedEvent;
  public Producer<String, NodeShapeScaleChangedEvent> kProducer_NodeShapeScaleChangedEvent;

  public Consumer<String, ? extends NodeEvent> kConsumer_NodeEvent_All;

  //________________________________________________________________________________________________
  public Producer<String, NodeEvent> kProducer_NodeEvent_LoadSaveFile;

  public Producer<String, SessionBeignEvent> kProducer_SessionBeignEvent;

  public Admin kAdminClient;

  //______________________________________________________________________________________
  //___________________________________________________________________________
  public String kTopicName_Send_NodeEvent_All;
  public String kTopicName_Receive_NodeEvent_All;
  public String kPartitionOrderKey_OrderAllNodeEvent = "OrderAllNodeEvent"; //__________________________________________________________________________________________________

  //___________________________________________________________________________

  public void init(String kTopicName_Send_NodeEvent_All, String kTopicName_Receive_NodeEvent_All) {
    if (!StaticValueDebug.det_DisableReceiveNetworkMsg_Kafka) {
      kProp_Admin.setProperty(AdminClientConfig.BOOTSTRAP_SERVERS_CONFIG, StaticValueDebug_Kafka.ip_bootstrapServers);
      this.kAdminClient                     = Admin.create(kProp_Admin);

      this.kTopicName_Send_NodeEvent_All    = kTopicName_Send_NodeEvent_All;
      this.kTopicName_Receive_NodeEvent_All = kTopicName_Receive_NodeEvent_All;

      KafkaUtil.create_NewTopic_ifNotExist(kTopicName_Send_NodeEvent_All, kAdminClient);
      KafkaUtil.create_NewTopic_ifNotExist(kTopicName_Receive_NodeEvent_All, kAdminClient); 
      //_______________________________________________________________________________
      //____________________________________________________________________________________

      //______________________________________

      kProp_Producer.setProperty(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, StaticValueDebug_Kafka.ip_bootstrapServers);
      kProp_Producer.setProperty(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());
      kProp_Producer.setProperty(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, SerializationUtilsSerializer.class.getName());

      kProp_Consumer.setProperty(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, StaticValueDebug_Kafka.ip_bootstrapServers);
      kProp_Consumer.setProperty(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());
      kProp_Consumer.setProperty(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, SerializationUtilsDeserializer.class.getName());

      kProp_Consumer.setProperty(ConsumerConfig.GROUP_ID_CONFIG, "group_drc"); //____________________________________________________________________________________________
      kProp_Consumer.setProperty(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, "earliest");

      this.kProducer_NodeCreatedEvent                              = new KafkaProducer<>(kProp_Producer);
      this.kProducer_NodeMovedEvent                                = new KafkaProducer<>(kProp_Producer);
      this.kProducer_NodeShapeSizeChangedEvent                     = new KafkaProducer<>(kProp_Producer);
      this.kProducer_NodeRelationshipContainmentStatusChangedEvent = new KafkaProducer<>(kProp_Producer);
      this.kProducer_TextChangedEvent                              = new KafkaProducer<>(kProp_Producer);
      this.kProducer_PaintDotChangedEvent                          = new KafkaProducer<>(kProp_Producer);
      this.kProducer_NodeRemovedEvent                              = new KafkaProducer<>(kProp_Producer);
      this.kProducer_NodeFocusStatusChangedEvent                   = new KafkaProducer<>(kProp_Producer);
      this.kProducer_FunctionExecutionEvent                        = new KafkaProducer<>(kProp_Producer);
      this.kProducer_UndoCompensationStepAddedEvent                = new KafkaProducer<>(kProp_Producer);
      this.kProducer_RedoCompensationStepAddedEvent                = new KafkaProducer<>(kProp_Producer);
      this.kProducer_UndoCheckpointPlacedEvent                     = new KafkaProducer<>(kProp_Producer);
      this.kProducer_UndoEvent                                     = new KafkaProducer<>(kProp_Producer);
      this.kProducer_RedoEvent                                     = new KafkaProducer<>(kProp_Producer);
      this.kProducer_ArrowMovedEvent                               = new KafkaProducer<>(kProp_Producer);
      this.kProducer_PaintRectClearEvent                           = new KafkaProducer<>(kProp_Producer);
      this.kProducer_NodeLayerMovedEvent                           = new KafkaProducer<>(kProp_Producer);
      this.kProducer_NodeShapeScaleChangedEvent                    = new KafkaProducer<>(kProp_Producer);

      this.kConsumer_NodeEvent_All                                 = new KafkaConsumer<>(kProp_Consumer);

      this.kProducer_NodeEvent_LoadSaveFile                        = new KafkaProducer<>(kProp_Producer);

      this.kProducer_SessionBeignEvent                             = new KafkaProducer<>(kProp_Producer);
    }
    else {
      System.out.println(">> KafkaConfig.init() :: det_DisableReceiveNetworkMsg_Kafka :: " + StaticValueDebug.det_DisableReceiveNetworkMsg_Kafka);
    }
  }

}